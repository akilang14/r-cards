# program to rename the pdf files by the name inside it.

import os
import PyPDF2

def reset_eof_of_pdf_return_stream(pdf_stream_in:list):
    # find the line position of the EOF
    for i, x in enumerate(pdf_stream_in[::-1]):
        if b'%%EOF' in x:
            actual_line = len(pdf_stream_in)-i
            print(f'EOF found at line position {-i} = actual {actual_line}, with value {x}')
            break
    # return the list up to that point
    return pdf_stream_in[:actual_line]
 
 def rename_pdf():
    """To rename the PDF files in the given folder with the name inside it"""
    folder = input("Enter the Folder name you want to rename file: ")
    NEW_DIR ='/Users/Admin/Documents/R Cards'
    DEST_DIR = os.path.join(NEW_DIR, folder)
    for count, f in enumerate(os.listdir(DEST_DIR)):
        f_name, f_text = os.path.splitext(f)
        with open(os.path.join(DEST_DIR,f), 'rb') as p:
            txt = (p.readlines())
            txtx = reset_eof_of_pdf_return_stream(txt)
        with open("C:/Users/Admin/Documents/R Cards/New folder/data.pdf", 'wb') as j:
            j.writelines(txtx)
        data_pdf = PyPDF2.PdfFileReader("C:/Users/Admin/Documents/R Cards/New folder/data.pdf")
        pageObj = data_pdf.getPage(0)
        my_string = pageObj.extractText()
        f_name = my_string.splitlines()[0]
        new_name = f'{f_name}{f_text}'
        os.rename(os.path.join(DEST_DIR, f), os.path.join(DEST_DIR,new_name))
       
rename_pdf()
